[2025-02-18 10:02:08 root] (main_smooth.py 548): INFO Namespace(model='/workspace/volume/inference-soft-data/AE/llm/models/llama-7b-hf', cache_dir='./cache', output_dir='./log-smooth/llama-7b-hf-w8a8', save_dir='./log-smooth/quant/llama-7b-hf-w8a8', resume=None, real_quant=False, calib_dataset='wikitext2', nsamples=128, batch_size=1, seed=2, tasks='piqa,arc_easy,arc_challenge,boolq,hellaswag,winogrande', eval_ppl=True, num_fewshot=0, wbits=8, abits=8, group_size=None, alpha=0.5, let_lr=0.005, lwc_lr=0.01, wd=0, epochs=10, let=True, lwc=False, symmetric=False, disable_zero_point=False, a_dynamic_method='per_token', w_dynamic_method='per_channel', limit=-1, multigpu=False, deactive_amp=True, attn_implementation='eager', net=None, act_scales=None, act_shifts=None, scale_calibration=True, compensation_calibration=False)
[2025-02-18 10:04:48 root] (main_smooth.py 615): INFO === start quantization ===
[2025-02-18 10:09:23 root] (main_smooth.py 640): INFO 275.67166662216187
[2025-02-18 10:09:52 root] (main_smooth.py 117): INFO load calibration from ./cache/testloader_llama_wikitext2_all.cache
[2025-02-18 10:10:45 root] (main_smooth.py 161): INFO wikitext2 : 5.785220146179199
[2025-02-18 10:10:45 root] (main_smooth.py 117): INFO load calibration from ./cache/testloader_llama_c4_all.cache
[2025-02-18 10:12:05 root] (main_smooth.py 161): INFO c4 : 7.197903156280518
[2025-02-18 11:16:51 root] (main_smooth.py 172): INFO {'wikitext2': 5.785220146179199, 'c4': 7.197903156280518, 'results': {'arc_easy': {'acc': 0.6792929292929293, 'acc_stderr': 0.00957747457110883, 'acc_norm': 0.5311447811447811, 'acc_norm_stderr': 0.010239860250021748}, 'hellaswag': {'acc': 0.5611431985660227, 'acc_stderr': 0.004952332378120329, 'acc_norm': 0.7247560246962756, 'acc_norm_stderr': 0.0044572433366165}, 'boolq': {'acc': 0.736085626911315, 'acc_stderr': 0.0077088257684303834}, 'piqa': {'acc': 0.7769314472252449, 'acc_stderr': 0.009713057213018517, 'acc_norm': 0.7742110990206746, 'acc_norm_stderr': 0.00975498067091731}, 'arc_challenge': {'acc': 0.39419795221843, 'acc_stderr': 0.014280522667467325, 'acc_norm': 0.41467576791808874, 'acc_norm_stderr': 0.014397070564409174}, 'winogrande': {'acc': 0.6582478295185478, 'acc_stderr': 0.013330103018622872}}, 'versions': {'arc_easy': 0, 'hellaswag': 0, 'boolq': 1, 'piqa': 0, 'arc_challenge': 0, 'winogrande': 0}, 'config': {'model_args': None, 'num_fewshot': 0, 'limit': None, 'bootstrap_iters': 100000, 'description_dict': None}}
