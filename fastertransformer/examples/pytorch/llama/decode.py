

from transformers import (
    AutoConfig,
    AutoTokenizer,
    AutoModelForCausalLM,
    AutoModelForSeq2SeqLM,
    Text2TextGenerationPipeline,
)
import pdb
import torch
import sys
import json

tokenizer_dir = "/opt/tiger/llama_cc/tokenizer"
tokenizer = AutoTokenizer.from_pretrained(tokenizer_dir, use_fast=False)
eos_token_id = int(tokenizer("</MOBAN>", )['input_ids'][1])
print(eos_token_id)
tokenizer.eos_token_id = eos_token_id

output = [1, 835, 10567, 29901, 39480, 41235, 30214, 40316, 34925, 13, 2277, 29937, 6125, 29901, 29903, 1759, 9029, 29899, 29895, 2518, 306, 655, 29899, 26350, 13, 2277, 29937, 826, 3174, 29901, 33829, 29892, 32755, 29901, 30528, 29922, 29929, 33983, 29953, 29936, 29871, 30594, 31143, 29892, 29953, 29879, 13, 2277, 29937, 6667, 1860, 33983, 13, 2277, 29937, 10619, 29879, 29901, 29879, 41925, 3946, 29899, 32517, 29947, 36203, 32674, 34901, 35885, 33588, 33441, 32427, 32209, 34750, 32517, 29892, 29879, 41925, 3946, 34624, 35232, 29953, 36203, 36252, 33488, 34750, 33022, 41998, 34182, 32653, 32114, 29892, 29879, 41925, 3946, 35738, 32197, 36203, 35425, 33012, 32730, 32215, 35903, 38133, 34234, 34657, 29892, 29879, 41925, 3946, 34624, 34521, 29955, 36203, 36252, 33488, 34750, 32427, 35127, 37159, 32114, 32215, 32730, 29892, 29879, 41925, 3946, 34624, 34521, 29946, 36203, 36252, 35153, 34741, 32337, 37159, 32292, 32653, 32406, 32177, 29892, 29879, 41925, 3946, 34624, 32427, 36203, 36480, 34553, 32004, 36245, 32674, 32177, 32031, 33627, 32427, 29892, 29879, 41925, 3946, 34624, 35127, 29906, 36203, 36252, 35153, 34741, 32427, 33724, 32004, 35692, 34361, 32674, 13, 2277, 29937, 13291, 29901, 54086, 54088, 54095, 36055, 32475, 54073, 54105, 34433, 32031, 54083, 54066, 54104, 54090, 35262, 34468, 29900, 54068, 54082, 54099, 54096, 269, 41925, 3946, 34624, 34521, 29946, 36203, 36252, 35153, 34741, 32337, 37159, 32292, 32653, 32406, 32177, 54074, 54097, 37591, 29889, 35425, 54075, 54101, 54090, 33259, 33961, 54068, 54098, 37591, 54076, 54079, 54102, 54106, 448, 29900, 29889, 34055, 54084, 54107, 37591, 29889, 34055, 54085, 54080, 54077, 54099, 54096, 269, 41925, 3946, 34624, 34521, 29955, 36203, 36252, 33488, 34750, 32427, 35127, 37159, 32114, 32215, 32730, 54074, 54097, 37591, 29889, 34750, 54075, 54101, 54090, 33259, 33961, 54068, 54098, 33259, 33961, 54076, 54079, 54102, 54106, 37591, 29889, 35425, 54084, 54107, 37591, 29889, 34055, 54085, 54080, 54077, 54099, 54096, 269, 41925, 3946, 34624, 35127, 29906, 36203, 36252, 35153, 34741, 32427, 33724, 32004, 35692, 34361, 32674, 54074, 54097, 37591, 29889, 34055, 54075, 54101, 54090, 33259, 33961, 54068, 54098, 37591, 54076, 54079, 54102, 54106, 37591, 29889, 35001, 54084, 54107, 37591, 29889, 34055, 54085, 54080, 54077, 54099, 54096, 269, 41925, 3946, 35738, 32197, 36203, 35425, 33012, 32730, 32215, 35903, 38133, 34234, 34657, 54074, 54097, 37591, 29889, 34750, 54075, 54101, 54090, 33259, 33961, 54068, 54098, 33259, 33961, 54076, 54079, 54102, 54106, 448, 29900, 29889, 35042, 54084, 54107, 37591, 29889, 34055, 54085, 54080, 54077, 54099, 54096, 269, 41925, 3946, 34624, 35232, 29953, 36203, 36252, 33488, 34750, 33022, 41998, 34182, 32653, 32114, 54074, 54097, 37591, 29889, 34055, 54075, 54101, 54090, 33259, 33961, 54068, 54098, 37591, 54076, 54079, 54102, 54106, 448, 29900, 29889, 34741, 54084, 54107, 448, 29900, 29889, 34741, 54085, 54080, 54077, 54099, 54096, 269, 41925, 3946, 35738, 32197, 36203, 35425, 33012, 32730, 32215, 35903, 38133, 34234, 34657, 54074, 54097, 37591, 29889, 34750, 54075, 54101, 54090, 33259, 33961, 54068, 54098, 33259, 33961, 54076, 54079, 54102, 54106, 37591, 29889, 34901, 54084, 54107, 448, 29900, 29889, 34055, 54085, 54080, 54077, 54099, 54096, 269, 41925, 3946, 29899, 32517, 29947, 36203, 32674, 34901, 35885, 33588, 33441, 32427, 32209, 34750, 32517, 54074, 54097, 37591, 29889, 34055, 54075, 54101, 54090, 33259, 33961, 54068, 54098, 37591, 54076, 54079, 54102, 54106, 37591, 29889, 29900, 54084, 54107, 448, 29900, 29889, 34750, 54085, 54080, 54077, 54099, 54096, 269, 41925, 3946, 34624, 32427, 36203, 36480, 34553, 32004, 36245, 32674, 32177, 32031, 33627, 32427, 54074, 54097, 37591, 29889, 34750, 54075, 54101, 54090, 33259, 33961, 54068, 54098, 33259, 33961, 54076, 54079, 54102, 54106, 448, 29900, 29889, 34076, 54084, 54107, 448, 29900, 29889, 34055, 54085, 54080, 54077, 54100, 529, 2780, 29958, 29937, 600, 311, 32517, 829, 2780, 29958, 54089, 29871, 32125, 32852, 32669, 54067, 54093, 4079, 29899, 3945, 29899, 50204, 54071, 54094, 39291, 29889, 29900, 54072, 54097, 33491, 34032, 54075, 54101, 54090, 33259, 33961, 54068, 54098, 37591, 54076, 54079, 54102, 54106, 37591, 29889, 29900, 54084, 54107, 37591, 29889, 34055, 54085, 54080, 54078, 54100, 529, 2780, 29958, 29937, 600, 311, 32517, 829, 2780, 29958, 54089, 33254, 36089, 33806, 33739, 54067, 54093, 4079, 29899, 3945, 29899, 50204, 54071, 54094, 39291, 29889, 29900, 54072, 54097, 33491, 34032, 54075, 54101, 54090, 33259, 33961, 54068, 54098, 33259, 33961, 54076, 54079, 54102, 54106, 37591, 29889, 29900, 54084, 54107, 37591, 29889, 34055, 54085, 54080, 54078, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, 54064, ] 

kwargs_batch_decode = {}
kwargs_batch_decode['spaces_between_special_tokens'] = False
output_text = tokenizer.decode(output,
                               clean_up_tokenization_spaces=True,
                               **kwargs_batch_decode)
output_text = output_text.split("</MOBAN>")[0]
print(output_text)

